@model List<Book_ListBookCategories>
@using Project_Work_Libreria.Database;
@using Project_Work_Libreria.Models.ModelForViews;


@{
    List<Book> bookPerCategory = new();
    List<BookCategory> bookCategories = new();
    using(BookShopContext db = new())
    {
        foreach(BookCategory bookCategory in db.Categories){
            bookCategories.Add(bookCategory);

            foreach(Book book in db.Book.Where(book => book.BookCategoryId == bookCategory.Id))
            {
                bookPerCategory.Add(book);
            }   
        }
    }
}
<div class="main">
    <h1 class="text-center mb-0 mt-3 bianco">La tua libreria</h1>
      

<div class="container mt-5 mb-5">
    <div class="row justify-content-center">

            @foreach(BookCategory category in bookCategories)
            {     
                <div>
                <h1>@category.Name</h1>
                </div>
                

        
            foreach(Book book in bookPerCategory.Where(book => book.BookCategoryId == category.Id)){

           
           
                
                <div class="card col-3 mt-3 g-3 rounded-3 shadow borders">
                    <img src="@book.ImgSource" class="mt-3 mx-1 rounded-3" />
                    <h1 class="text-center mt-2">@book.Title</h1>
                    <p class="text-center">@book.Description</p>
                 


                    <div class="text-center mb-3 d-flex justify-content-around">

                        <div class="mt-auto">


                            <a href="@Url.Action("Details", "Book", new {id = book.Id})">
                                <button type="button" class="btn btn-secondary btn-sm dettagli btn-warning">Dettagli</button>
                            </a>
                        </div>

                        <div class="mt-auto">
                            <form asp-controller="PurchaseData" asp-action="Create" asp-route-id="@book.Id" method="get" class="mt-3">
                                @Html.AntiForgeryToken()
                                <button type="submit" class="btn btn-secondary btn-sm dettagli btn-success">
                                    Acquista
                                </button>
                            </form>
                        </div>

                        
                        
                   
                    </div>

                </div>
                            
           
            }
            }



        </div>
    </div>
</div>

